{include file="public/header" /}
<!--内容显示-->
<link rel="stylesheet" href="__STATIC__/shop/css.css">
<script type="text/javascript" src="__STATIC__/ue/ueditor.config.js"></script>
<script type="text/javascript" src="__STATIC__/ue/ueditor.all.js"></script>
<script type="text/javascript">
    window.onload=function () {
            var ue = UE.getEditor('editor');
        }
</script>
<div class="row">
    <div class="col-lg-12" style="margin-top: 25px;">
        <div class="panel panel-default">
            <!--标头-->
            <div class="panel-heading ArtManHeader">
                <div style="float: left"><a href="../home/index">后台管理中心</a> - {$Title}<a href="../Home/ReturnOne" style="margin-left: 15px;"><i class="fa fa-reply fa-fw"></i></a></div>
            </div>
            <!--添加商品信息-->
            <div class="panel-body">
                <!-- Nav tabs -->
                <ul class="nav nav-tabs">
                    <li id="jibenxinxi" class="active"><a href="#basic" data-toggle="tab" aria-expanded="false">基本信息</a></li>
                    <li id="xiangqing"><a href="#xiangqing1" data-toggle="tab">详细信息</a></li>
                    <li id="goodsxiangce"><a href="#album" data-toggle="tab">商品相册</a></li>
                </ul>
                <!-- Tab panes -->
                <div class="tab-content">
                    {volist name="GoodsData" id="GoodsData"}
                    <div class="tab-pane fade active in" id="basic" >
                        <form class="form-horizontal ajaxForm2" id="GoodsGFrom" method="get" action="../Goodsmanage/UpdateGoods" >
                            <!--<h4>基本信息</h4>-->
                            <div id="jiben" style="margin-left:20%;margin-top: 35px;">
                                <div class="form-group">
                                    <label class="col-sm-2 control-label no-padding-right"> 商品名称： </label>
                                    <div class="col-sm-10">
                                        <!--<input value={$GoodsData.goods_id} type="hidden" name="id">-->
                                        <input value={$GoodsData.goods_name} type="text" name="name" class="col-xs-10 col-sm-6 form-control" style="float: left;width:250px;display: block;">
                                        <i class="fa fa-fw fa-question-circle" style="float: left;display: block;height: 34px;line-height: 34px;margin-left: 5px;" data-toggle="tooltip" data-placement="right" title="商品名称为必填项"></i>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label class="col-sm-2 control-label no-padding-right"> 商品别名： </label>
                                    <div class="col-sm-10">
                                        <input value={$GoodsData.goods_alias_name} type="text" name="biename" class="col-xs-10 col-sm-6 form-control" style="float: left;width: 250px;display: block;">
                                        <i class="fa fa-fw fa-question-circle" style="float: left;display: block;height: 34px;line-height: 34px;margin-left: 5px;" data-toggle="tooltip" data-placement="right" title="商品别名为选填项,如果为空,将默认为商品名称"></i>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label class="col-sm-2 control-label no-padding-right"> 商品货号： </label>
                                    <div class="col-sm-10">
                                        <input value={$GoodsData.goods_code} type="text" name="huohao" class="col-xs-10 col-sm-6 form-control" style="float: left;width:250px;display: block;" readonly="readonly">
                                        <!--<i class="fa fa-fw fa-question-circle" style="float: left;display: block;height: 34px;line-height: 34px;margin-left: 5px;" data-toggle="tooltip" data-placement="right" title="如果您不输入商品货号，系统将自动生成一个唯一的货号。"></i>-->
                                        <i id="rand"class="fa fa-star fa-fw" style="float: left;display: block;height: 34px;line-height: 34px;margin-left: 5px;"data-toggle="tooltip" data-placement="right" title="商品货单号唯一,不可更改"></i>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label class="col-sm-2 control-label no-padding-right"> 商品类别： </label>
                                    <input type="hidden" name="type" value={$GoodsData.goods_type}>
                                    <div class="col-sm-10">
                                        <div id="GoodsType">
                                            <input  value={$GoodsType} type="text" name="GoodsType" class="col-xs-10 col-sm-6 form-control" style="float: left;width: 250px;display: block;" readonly="readonly">
                                        </div>
                                        <!--<i id="tishi" class="fa fa-fw fa-question-circle" style="float: left;display: block;height: 34px;line-height: 34px;margin-left: 5px;" data-toggle="tooltip" data-placement="right" title="商品类别为必选项"></i>-->
                                        <i id="UpType" class="fa fa-fw fa-pencil" style="float: left;display: block;height: 34px;line-height: 34px;margin-left: 5px;"data-toggle="tooltip" data-placement="right" title="商品类别为必选项,点击添加一个类"></i>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label class="col-sm-2 control-label no-padding-right"> 商品供应商： </label>
                                    <input type="hidden" name="brand" value={$GoodsData.goods_brand}>
                                    <div class="col-sm-10">
                                        <div id="GoodsBrand">
                                            <input  value={$GoodsBrand} type="text" name="GoodsBrand" class="col-xs-10 col-sm-6 form-control" style="float: left;width: 250px;display: block;" readonly="readonly">
                                        </div>
                                        <i  id="UpBrand" class="fa fa-fw fa-pencil" style="float: left;display: block;height: 34px;line-height: 34px;margin-left: 5px;" data-toggle="tooltip" data-placement="right" title="商品品牌为必选项"></i>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label class="col-sm-2 control-label no-padding-right"> 商品售价： </label>
                                    <div class="col-sm-10">
                                        <input  value={$GoodsData.goods_price} type="text" name="shoujia" class="col-xs-10 col-sm-6 form-control" style="float: left;width: 250px;display: block;">
                                        <i class="fa fa-fw fa-question-circle" style="float: left;display: block;height: 34px;line-height: 34px;margin-left: 5px;" data-toggle="tooltip" data-placement="right" title="商品售价为必填项"></i>
                                    </div>

                                </div>
                                <div class="form-group">
                                    <label class="col-sm-2 control-label no-padding-right"> 商品市场价： </label>
                                    <div class="col-sm-10">
                                        <input  value={$GoodsData.goods_market_price} type="text" name="shichangjia" class="col-xs-10 col-sm-6 form-control" style="float: left;width:250px;display: block;">
                                        <i class="fa fa-fw fa-question-circle" style="float: left;display: block;height: 34px;line-height: 34px;margin-left: 5px;" data-toggle="tooltip" data-placement="right" title="商品市场价为必选项"></i>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label class="col-sm-2 control-label no-padding-right"> 商品成本价： </label>
                                    <div class="col-sm-10">
                                        <input value={$GoodsData.goods_cost_price} type="text" name="chengbenjia" class="col-xs-10 col-sm-6 form-control" style="float: left;width:250px;display: block;">
                                        <i class="fa fa-fw fa-question-circle" style="float: left;display: block;height: 34px;line-height: 34px;margin-left: 5px;" data-toggle="tooltip" data-placement="right" title="商品成本价为必选项"></i>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label class="col-sm-2 control-label no-padding-right"> 商品库存： </label>
                                    <div class="col-sm-10">
                                        <input value={$GoodsData.goods_stock} type="text" name="kucun" class="col-xs-10 col-sm-6 form-control" style="float: left;width: 250px;display: block;">
                                        <i class="fa fa-fw fa-question-circle" style="float: left;display: block;height: 34px;line-height: 34px;margin-left: 5px;" data-toggle="tooltip" data-placement="right" title="商品库存为必填项"></i>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label class="col-sm-2 control-label no-padding-right"> 商品关键字： </label>
                                    <div class="col-sm-10">
                                        <input value={$GoodsData.goods_keyword} type="text" name="guanjianzi" class="col-xs-10 col-sm-6 form-control" style="float: left;width: 250px;display: block;">
                                        <i class="fa fa-fw fa-question-circle" style="float: left;display: block;height: 34px;line-height: 34px;margin-left: 5px;" data-toggle="tooltip" data-placement="right" title="关键字为选填项,以 | 相隔多个关键字"></i>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label class="col-sm-2 control-label no-padding-right"> 商品效果图： </label>
                                    <div class="col-sm-10">
                                        <input id="files" type="file" style="display:none" onchange="showImgs()">
                                        <div class="input-append">
                                            <input value='{$GoodsData.goods_thumbnail}' id="photoCover"  class="input-large form-control" type="text" style="height:30px;width:250px;float: left" readonly="readonly">
                                            <i onclick="$('input[id=files]').click();" class="fa fa-fw fa-plus-circle " style="float: left;display: block;height: 34px;line-height: 34px;margin-left: 5px;" data-toggle="tooltip" data-placement="right" title="点击添加商品信息图"></i>
                                            <div style="position: absolute;right:90px;top: -170px;">
                                                <img id="ReturnImg" src="{$GoodsData.goods_thumbnail}" style="width: 300px;height: 200px;" class="img-rounded" />
                                            </div>
                                            <i id="Delimg" class="fa fa-trash-o fa-fw"  style="float: left;display: block;height: 34px;line-height: 34px;margin-left: 5px;"  title="删除商品缩略图"></i>
                                        </div>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label class="col-sm-2 control-label no-padding-right"> 商品效果视频： </label>
                                    <div class="col-sm-10">
                                        <input id="video" value='{$GoodsData.goods_video}' type="file" style="display:none" onchange="showVideo()">
                                        <div class="input-append">
                                            <input value='{$GoodsData.goods_video}'  id="videoUrl"  class="input-large form-control" type="text" style="height:30px;width:250px;float: left" readonly="readonly">
                                            <i onclick="$('input[id=video]').click();" class="fa fa-fw fa-plus-circle " style="float: left;display: block;height: 34px;line-height: 34px;margin-left: 5px;" data-toggle="tooltip" data-placement="right" title="点击添加商品视频"></i>
                                            <div style="position: absolute;right:90px;top: -25px;">
                                                <video id="RrturnVideo" src="{$GoodsData.goods_video}" style="width: 300px;height: 250px;" class="img-rounded"  controls="controls"></video>
                                            </div>
                                            <i id="Delvideo" class="fa fa-trash-o fa-fw"  style="float: left;display: block;height: 34px;line-height: 34px;margin-left: 5px;"  title="删除商品视频"></i>
                                        </div>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label class="col-sm-2 control-label no-padding-right"> 虚拟商品： </label>
                                    <div class="col-sm-5">
                                        <ul class="pagination" style="display: inline-block;padding-left:  85px;float: left;margin: 0 0;" id="fictitious">
                                            <?php
                                         if($GoodsData['goods_virtal'] === 1)
                                            echo  "<li class='active'><a data-id='1'>是</a></li> <li><a data-id='2'>否</a></li>";
                                                else  echo  "<li><a data-id='1'>是</a></li> <li  class='active'><a data-id='2'>否</a></li>";
                                             ?>

                                        </ul><i class="fa fa-fw fa-question-circle" style="float: left;display: block;height: 34px;line-height: 34px;margin-left: 5px;" data-toggle="tooltip" data-placement="right" title="默认为否"></i>
                                    </div>
                                    <input type="hidden" name="xuni">
                                    <div class="space-4"></div>
                                </div>
                                <div class="form-group">
                                    <label class="col-sm-2 control-label no-padding-right"> 是否上架： </label>
                                    <div class="col-sm-5">
                                        <ul class="pagination" style="display: inline-block;padding-left:  85px;float: left;margin: 0 0;" id="shelf">
                                            <?php
                                         if($GoodsData['goods_state'] === 1)
                                            echo  "<li class='active'><a data-id='1'>是</a></li> <li><a data-id='2'>否</a></li>";
                                            else  echo  "<li><a data-id='1'>是</a></li> <li  class='active'><a data-id='2'>否</a></li>";
                                            ?>
                                            <input type="hidden" name="shangjia">
                                        </ul>
                                        <i class="fa fa-fw fa-question-circle" style="float: left;display: block;height: 34px;line-height: 34px;margin-left: 5px;" data-toggle="tooltip" data-placement="right" title="默认为上架"></i>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label class="col-sm-2 control-label no-padding-right"> 商品包邮： </label>
                                    <div class="col-sm-5">
                                        <ul class="pagination" style="display: inline-block;padding-left: 85px;float: left;margin: 0 0;" id="free">
                                            <?php
                                         if($GoodsData['goods_shipping'] === 1)
                                            echo  "<li class='active'><a data-id='1'>是</a></li> <li><a data-id='2'>否</a></li>";
                                            else  echo  "<li><a data-id='1'>是</a></li> <li  class='active'><a data-id='2'>否</a></li>";
                                            ?>
                                            <input type="hidden" name="baoyou">
                                        </ul>
                                        <i class="fa fa-fw fa-question-circle" style="float: left;display: block;height: 34px;line-height: 34px;margin-left: 5px;" data-toggle="tooltip" data-placement="right" title="默认为包邮"></i>
                                    </div>

                                    <div class="space-4"></div>
                                </div>
                                <div class="form-group">
                                    <label class="col-sm-2 control-label no-padding-right"> 商品添加时间： </label>
                                    <div class="col-sm-3">
                                        <input value={$GoodsData.goods_addtime} id="time" type="text" name="addtime" class="col-xs-10 col-sm-6 form-control" style="float: left;width:250px;display: block;"readonly>
                                    </div>

                                    <div class="space-4"></div>
                                </div>
                            </div>

                            <div class="clearfix form-actions" style="margin-left: 10%;margin-top: 5%">
                                <div class="col-md-offset-3 col-md-9">
                                    <button class="btn btn-info" type="button" name="updataBtn">
                                        <i class="ace-icon fa fa-check bigger-110"></i>
                                        修改基本信息
                                    </button>
                                    &nbsp; &nbsp; &nbsp;
                                    <button class="btn" type="reset">
                                        <i class="ace-icon fa fa-undo bigger-110"></i>
                                        重置
                                    </button>
                                </div>
                            </div>
                        </form>
                    </div>

                    <div class="tab-pane fade" id="xiangqing1">
                        <!--<div id="xiangqing" style="display: none;margin: 15px;">-->
                        <input value={$GoodsData.goods_id} type="hidden" name="id">
                            <textarea id="editor" name="Textarea" style="width: 100%;height: 350px;margin: 0 auto; margin-top: 5px;">{$GoodsData.goods_info}</textarea>
                        <div class="clearfix form-actions" style="margin-left: 10%;margin-top: 5%">
                            <div class="col-md-offset-3 col-md-9">
                                <button class="btn btn-info" type="button" name="UpdateInforBtM">
                                    <i class="ace-icon fa fa-check bigger-110"></i>
                                    修改详细信息
                                </button>
                                &nbsp; &nbsp; &nbsp;
                                <button class="btn" type="reset">
                                    <i class="ace-icon fa fa-undo bigger-110"></i>
                                    重置
                                </button>
                            </div>
                        </div>
                        <!--</div>-->
                    </div>
                    <div class="tab-pane fade" id="album">
                        <div style="margin: 15px;">
                            <!--<a href="../Home/ReturnOne" style="margin-left: 15px;"><i class="fa fa-reply fa-fw"></i>返回上一层</a>.-->
                            <div  style="margin-top: 15px;width: 100%;;border: 1px #dddddd solid">
                                <input value={$GoodsData.goods_code} type="hidden" name="Img_code">
                                <ul id="ImgUl">
                                    {volist name="ImagesData" id="ImagesData"}
                                    <li><img data-id={$ImagesData.goods_images_id} src={$ImagesData.goods_images_url} height='100%' width='100%'/><div class='Dele dis'><i class='fa fa-fw  fa-trash-o'></i></div></li>
                                    {/volist}
                                </ul>

                                <div style="width: 90%;margin: 0 auto 10px;line-height: 50px;">
                                    <div style="margin: 0 auto;width:40%; ">
                                        <input type="file" id="imgsFile" style="display: none"  onchange="Album()">
                                        <button type="button" class="btn btn-outline btn-default" onclick="AddClick()">
                                            <i class="ace-icon fa fa-image bigger-110"></i>
                                            添加图片
                                        </button>
                                        &nbsp; &nbsp; &nbsp;
                                        <button class="btn btn-outline btn-info" type="button" name="AddImgBtn" >
                                            <i class="ace-icon fa fa-check bigger-110"></i>
                                            上传
                                        </button>
                                        &nbsp; &nbsp; &nbsp;
                                        <button class="btn btn-outline btn-danger" type="button" onclick="fangqi()">
                                            <i class="ace-icon fa fa-times bigger-110"></i>
                                            放弃
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    {/volist}
                </div>
            </div>
        </div>
    </div>
</div>
<script type="text/javascript">
    /*显示图片*/
    function showImgs() {
        var formdata=new FormData();
        formdata.append("files" , $("input[type='file']")[0].files[0]);
        $.ajax({
            type:"POST",
            url:"../Goodsmanage/showLogo",
            data:formdata,
            cache:false,
            processData:false,
            contentType:false,
            success:function(data){
                $("#photoCover").val("");
                $("#photoCover").val(data);
                $("#ReturnImg").attr("src",data);
                $("#ReturnImg").show();
                $("#Delimg").show();
            }
        })
    }
    $('input[id=files]').change(function() {
        $('#photoCover').val($(this).val());
    });
    /*显示图片*/
    function showImgs() {
        var formdata=new FormData();
        formdata.append("files" , $("#files")[0].files[0]);
        $.ajax({
            type:"POST",
            url: "../Goodsmanage/DelTemporaryImg",
            data:{}
        });
        $.ajax({
            type:"POST",
            url:"../Goodsmanage/showImg",
            data:formdata,
            cache:false,
            processData:false,
            contentType:false,
            success:function(data){
                $("#ReturnImg").attr("src",data);
                $("#ReturnImg").show();
                $("#Delimg").show();
            }
        })
    }
    /* 删除缩略图*/
    $("#Delimg").click(function () {
        $.ajax({
            type:"POST",
            url: "../Goodsmanage/DelTemporaryImg",
            data:{"url":$("#ReturnImg")[0].src}
        });
        $("#ReturnImg").hide();
        $("#ReturnImg").attr("src","");
        $("#files").val("");
        $("#photoCover").val("");
        $(this).hide();
    });
    /*JS 显示删除*/
    $("#ImgUl").find("li").mousemove(function () {
        $(this).find("div").removeClass("dis");
    });
    $("#ImgUl").find("li").mouseout(function () {
        $(this).find("div").addClass("dis");
    });
    $("#ImgUl li div").click(function () {
        console.log($(this).parent().find("img").attr("src"));
        $.ajax({
            type:"POST",
            url:"../Goodsmanage/DeleteAlbum",
            data:{"Img_id":$(this).parent().find("img").data("id"),"Img_src":$(this).parent().find("img").attr("src")},
        });
        $(this).parent().remove();
    });
    /**
     *  显示视频
     */
    function showVideo(){
        var formdata=new FormData();
        formdata.append("videos" , $("#video")[0].files[0]);
        $.ajax({
            type:"POST",
            url:"../Goodsmanage/showVideo",
            data:formdata,
            cache:false,
            processData:false,
            contentType:false,
            success:function(data){
                $("#RrturnVideo").attr("src",data);
                $("#RrturnVideo").show();
                $("#Delvideo").show();
            }
        });
    }
    /*显示文件上传的名称*/
    $('input[id=video]').change(function() {
        $('#videoUrl').val($(this).val());
    });
    /* 删除视频*/
    $("#Delvideo").click(function () {

        $.ajax({
            type:"POST",
            url: "../Goodsmanage/DelTemporaryVideo",
            data:{"url":$("#RrturnVideo")[0].src}
        });
        $("#RrturnVideo").hide();
        $("#RrturnVideo").attr("src","");
        $("#videoUrl").val("");
        $("#RrturnVideo").val("");
        $(this).hide();
    });
    /*修改类型*/
    $("#UpType").on("click",function () {
        var TypeClass = $(this).attr("class");
        if(TypeClass === "fa fa-fw fa-pencil"){
            $.ajax({
            type:"GET",
            url:"../Goodsmanage/ShowTypeList",
            data:{},
            dataType:"html",
            success : function(outData) {
                $("#GoodsType").html(outData);
            }
        });
        $(this).removeClass("fa-pencil").addClass("fa-repeat");
        }else {
            var Type = " <input  value={$GoodsType} type='text' name='type' class='col-xs-10 col-sm-6 form-control' style='float: left;width: 250px;display: block;' readonly='readonly'>";
            $("#GoodsType").html(Type);
            $(this).removeClass("fa-repeat").addClass("fa-pencil");
        }
    });
    /*修改供应商*/
    $("#UpBrand").on("click",function () {
        var TypeClass = $(this).attr("class");
        if(TypeClass === "fa fa-fw fa-pencil"){
            $.ajax({
                type:"GET",
                url:"../Goodsmanage/ShowBrandList",
                data:{},
                dataType:"html",
                success : function(outData) {
                    $("#GoodsBrand").html(outData);
                }
            });
            $(this).removeClass("fa-pencil").addClass("fa-repeat");
        }else {
            var brand = " <input  value={$GoodsBrand} type='text' name='brand' class='col-xs-10 col-sm-6 form-control' style='float: left;width: 250px;display: block;' readonly='readonly'>";
            $("#GoodsBrand").html(brand);
            $(this).removeClass("fa-repeat").addClass("fa-pencil");
        }
    });
    /*虚拟商品*/
    $("#fictitious").find("li").click(function () {
        $(this).addClass("active").siblings().removeClass("active");
        $("#free").find("li").eq(1).addClass("active").siblings().removeClass("active");
    });
    /*上架*/
    $("#shelf").find("li").click(function () {
        $(this).addClass("active").siblings().removeClass("active");
    });
    /*包邮*/
    $("#free").find("li").click(function () {
        $(this).addClass("active").siblings().removeClass("active");
    });
    $("button[name='updataBtn']").click(function () {
        UPdataJben();
    });
    function UPdataJben() {
        var name = $("input[name='name']").val();
        if(name!=""){
            /*商品别名*/
            var biename = $("input[name='biename']").val();
            if(biename!=""){
                /*商品huohao*/
                var huohao = $("input[name='huohao']").val();
                if(huohao!=""){
                    /*商品类别*/
                    var TypeClass = $("#UpType").attr("class");
                    if(TypeClass === "fa fa-fw fa-pencil") {
                        var GoodsType = $("input[name='GoodsType']").val();
                    }else if(TypeClass === "fa fa-fw fa-repeat"){
                        var OneType = $("select[name='OneType']").val();
                        var TwoType = $("select[name='TwoType']").val();
                        if(OneType!="-1") {
                            if (TwoType == "请选择...") {
                                $("input[name='type']").val(OneType);
                            } else   $("input[name='type']").val(TwoType);
                        }else $("select[name='OneType']").focus();
                    }
                    /*供应商*/
                    var TypeClass = $("#UpBrand").attr("class");
                    if (TypeClass === "fa fa-fw fa-pencil") {
                        var GoodsType = $("input[name='GoodsBrand']").val();
                    }else if(TypeClass === "fa fa-fw fa-repeat"){
                        var pinpai = $("select[name='pinpai']").val();
                        if(pinpai!="请选择..."){
                            $("input[name='brand']").val(pinpai);
                        }else $("select[name='pinpai']").focus();
                    }
                    /*商品售价*/
                    var shiojia =  $("input[name='shoujia']").val();
                    if(shiojia!=""){
                        /*市场价*/
                        var shichangjia =  $("input[name='shichangjia']").val();
                        if(shichangjia!=""){
                            /* 商品成本价*/
                            var chengbenjia =  $("input[name='chengbenjia']").val();
                            if(chengbenjia!=""){
                                /*库存*/
                                var kucun =  $("input[name='kucun']").val();
                                if(kucun!=""){
                                    /*关键字*/
                                    var guanjianzi =  $("input[name='guanjianzi']").val();
                                    if(guanjianzi!=""){
                                        var guanjianzi =  $("input[name='guanjianzi']").val();
                                        if(guanjianzi!=""){
                                            /*缩略图*/
                                            var img = $("#photoCover").val();
                                            //商品图片
                                            if(img!=""){
                                                /*虚拟*/
                                                var fictitiousli = $("#fictitious").find("li").length;
                                                for (var i = 0; i < fictitiousli; i++) {
                                                    if ($("#fictitious").find("li").eq(i).attr("class") == "active") {
                                                        var fictitious = $("#fictitious").find("li").eq(i).find("a").text();
                                                        if (fictitious === "是") {
                                                            $("input[name='xuni']").val("1");
                                                        } else {
                                                            $("input[name='xuni']").val("0");
                                                        }
                                                    }
                                                }
                                                /*上架*/
                                                var shelfli = $("#shelf").find("li").length;
                                                for (var i = 0; i < shelfli; i++) {
                                                    if ($("#shelf").find("li").eq(i).attr("class") == "active") {
                                                        var shelf = $("#shelf").find("li").eq(i).find("a").text();
                                                        if (shelf === "是") {
                                                            $("#shelf").find("input[name='shangjia']").val("1");
                                                        } else {
                                                            $("#shelf").find("input[name='shangjia']").val("0");
                                                        }
                                                    }
                                                }
                                                /*包邮*/
                                                var freeli = $("#free").find("li").length;
                                                for (var i = 0; i < freeli; i++) {
                                                    if ($("#free").find("li").eq(i).attr("class") == "active") {
                                                        var free = $("#free").find("li").eq(i).find("a").text();
                                                        if (free === "是") {
                                                            $("#free").find("input[name='baoyou']").val("1");
                                                        } else {
                                                            $("#free").find("input[name='baoyou']").val("0");
                                                        }
                                                    }
                                                }
                                                var confirmdel = confirm('确认要以上商品信息吗?');
                                                if (confirmdel) {
                                                    if($("#videoUrl").val()!==""){
                                                        $.ajax({
                                                            type:"POST",
                                                            url: "../Goodsmanage/UpdateVideo",
                                                            data:{"huohao":$("input[name='huohao']").val(),"VideoUrl":$("#RrturnVideo").attr("src")},

                                                        });
                                                    }
                                                    $.ajax({
                                                        type:"POST",
                                                        url: "../Goodsmanage/UpdateIMG",
                                                        data:{"huohao":$("input[name='huohao']").val(),"ImgUrl":$("#ReturnImg").attr("src")},
                                                    });
                                                    $.ajax({
                                                        type: $("#GoodsGFrom").attr("method"),
                                                        url: $("#GoodsGFrom").attr("action"),
                                                        data: $('#GoodsGFrom').serialize(),
                                                        dataType: "text",
                                                        traditional: true,
                                                        success: function (outData) {
                                                           alert("基本信息修改成功");
                                                            $("#jibenxinxi").find("a").append("<i class='fa fa-check fa-fw'> </i>")
//                                                            location.reload();
//                                                            window.setTimeout( ,1000);


//                                                            var confirmdel = confirm('是否修改该商品的详情信息?');
//                                                            if (confirmdel) {
//                                                                $("#xiangqing1").addClass("active in");
//                                                                $("#basic").removeClass("active in");
//                                                                $("#xiangqing").addClass("active");
//                                                                $("#jibenxinxi").removeClass("active");
//                                                                $("input[name='UpdateInforBtM']").on("click",function(){
//                                                                    uploadInfor();
//                                                                });
//                                                            }else{
//                                                                var confirmdel = confirm('是否修改的相册信息?');
//                                                                if (confirmdel) {
//                                                                    $("#album").addClass("active in");
//                                                                    $("#xiangqing1").removeClass("active in");
//                                                                    $("#goodsxiangce").addClass("active");
//                                                                    $("#xiangqing").removeClass("active");
//                                                                    $("button[name='AddImgBtn']").click(function () {
//                                                                        uploadAlbum()
//                                                                    });
//                                                                }
//                                                            }
                                                        }
                                                    });
                                                }

                                            }else $("#photoCover").focus();
                                        }else $("input[name='guanjianzi']").focus();
                                    }else $("input[name='guanjianzi']").focus();
                                }else $("input[name='kucun']").focus();
                            }else $("input[name='chengbenjia']").focus();
                        }else $("input[name='shichangjia']").focus();
                    }else $("input[name='shoujia']").focus();

                }else $("input[name='huohao']").focus();
            }else $("input[name='biename']").focus();
        }else $("input[name='name']").focus();
    }
    /**
     *  修改详细信息窗口
    */
    function uploadInfor(){
        $.ajax({
            type:"POST",
            url:"../Goodsmanage/UpdateInfor",
            data:{"id":$("input[name='id']").val(),"info":UE.getEditor("editor").getContent()},
            success:function (outData) {
                if(outData ==="1"){
//                    location.href="../GoodsManage/showUpdate?goods_id="+$("input[name='id']").val()+"";
                    alert("详细信息修改成功");
                    $("#xiangqing").find("a").append("<i class='fa fa-check fa-fw'> </i>")
                }
        }
        });
    }
    /** 修改按钮*/
    $("button[name='UpdateInforBtM']").click(function () {
        var confirmdel = confirm('确认要以上商品信息吗?');
        if(confirmdel) {
            uploadInfor();
        }
    });
    /*缩略图判断*/
    $(function () {
        var SLT = $("#photoCover").val();
        var SST = $("#videoUrl").val();
        if(SLT === ""){
           $("#Delimg").hide();
           $("#ReturnImg").hide();
        }
        if(SST === ""){
            $("#Delvideo").hide();
            $("#RrturnVideo").hide();
        }
    })


    /** 添加图片按钮*/
    function AddClick() {
        var lenght = $("#ImgUl").find("li").length;
        if(lenght>=0 && lenght<12) {
            $('input[id=imgsFile]').click();
        }else alert("图片最大数量为12");
    }
    /** 显示相册图片 */
    function Album() {
        var formdata=new FormData();
        formdata.append("files" , $("#imgsFile")[0].files[0]);
        $.ajax({
            type:"POST",
            url:"../Goodsmanage/showImg",
            data:formdata,
            cache:false,
            processData:false,
            contentType:false,
            success:function(data){
                var li =  " <li><img src="+data+" height='100%' width='100%'/><div class='Dele dis'><i class='fa fa-fw  fa-trash-o'></i></div></li>";
                //实例li、为 object 对象
                var objLi = $(li);
                $("#ImgUl").append(objLi);
                $("#ImgUl").find("li").mousemove(function () {
                    $(this).find("div").removeClass("dis");
                });
                $("#ImgUl").find("li").mouseout(function () {
                    $(this).find("div").addClass("dis");
                });
                objLi.find("div").on("click",function () {
                    $(this).parent().remove();
                    var src = $(this).parent().find("img")[0].src;
                    $.ajax({
                        type:"POST",
                        url: "../Goodsmanage/DelTemporaryImg",
                        data:{"url":src}
                    });
                });
            }
        })
    }
    /**
     *  上传相册
     */
    function uploadAlbum(){
        var huohao = $("input[name='huohao']").val();
        if (huohao == "") {
            /*货号不存在*/
            $("#basic").addClass("active in");
            $("#album").removeClass("active in");
            $("#jibenxinxi").addClass("active");
            $("#goodsxiangce").removeClass("active");
        } else {
            var lenght = $("#ImgUl").find("li").length;
            if(lenght>0 && lenght<=12) {
                var confirmdel3 = confirm('确定要添加以上图片至该商品相册吗?');
                if(confirmdel3){
                    /** AJAX 清除相册*/
                    $.ajax({
                        type: "POST",
                        url: "../Goodsmanage/CloseAlbum",
                        data: {"huohao":$("input[name='Img_code']").val()}
                    });
                    /**
                     * AJAX 添加到相册
                     */
                    for(var i=0;i<lenght ;i++) {
                        var Url = $("#ImgUl li").eq(i).find("img")[0].src;

                        $.ajax({
                            type: "GET",
                            url: "../Goodsmanage/CopyAlbum",
                            data: {"huohao":$("input[name='Img_code']").val(),"Url": Url},
                        });
                    }
                    $.ajax({
                        type: "POST",
                        url: "../Goodsmanage/DirDelete",
                        data: {}
                    });
                      alert("相册信息修改成功");
                    $("#goodsxiangce").find("a").append("<i class='fa fa-check fa-fw'> </i>")

                }
            }else alert('请选择需要上传的商品信息图片');
        }
    }
    /** 上传按钮*/
    $("button[name='AddImgBtn']").click(function () {
        uploadAlbum();
    });
    /**
     *  放弃按钮
     */
    function fangqi(){
        var confirmdel3 = confirm('确定要放弃添加图片吗?');
        if(confirmdel3) {
            window.location.href="../GoodsManage/showList?title=商品列表";
        }
    }
</script>
{include file="public/tail" /}
